<h2>Edit Profile</h2>

<%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put, class: 'form-horizontal' }) do |f| %>
  <% if devise_error_messages!.length > 0 %>
    <div class="alert alert-danger alert-dismissable">
      <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
      <h4><%= devise_error_messages! %></h4>
    </div>
  <% end %>

  <div class="form-group">
    <%= f.label :first_name, class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.text_field :first_name, autofocus: true, class: 'form-control'%>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :last_name, class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.text_field :last_name, class: 'form-control'%>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :email, class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.email_field :email, class: 'form-control'%>
    </div>
  </div>

  <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
    <div>Currently waiting confirmation for: <%= resource.unconfirmed_email %></div>
  <% end %>

  <div class="form-group">
    <%= f.label :password, 'New Password', class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.password_field :password, autocomplete: "off", class:'form-control', placeholder: 'leave blank if you don\'t want to change your password' %>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :password_confirmation, 'New Password Confirmation', class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.password_field :password_confirmation, autocomplete: "off", class: 'form-control' %>
    </div>
  </div>

  <div class="col-sm-2 col-sm-offset-2">
    <%= button_tag(type: 'submit', class: "btn btn-primary") do %>
      <span class="glyphicon glyphicon-edit"></span> Update
    <% end %>
  </div>

  <div class="row">
    <div class="col-sm-2">
      <%= link_to "Back", list_path(@user.lists.find_by(name: 'Default')), class: 'btn btn-primary' %>
    </div>

    <div class="col-sm-2">
      <%= link_to "Cancel my account", registration_path(resource_name), class: 'btn btn-danger', data: { confirm: "Are you sure?" }, method: :delete %>
    </div>
  </div>

<% end %>

<br/>
<% if current_user.provider == 'facebook' %>
  <div class="row">
    <div class="alert alert-info col-sm-6 col-sm-offset-2">
      Your TuDu account is linked to the <%= "#{current_user.provider} account for #{current_user.first_name} #{current_user.last_name}" %>.
    </div>
  </div>
<% else %>
  <div class="row">
    <div class="alert alert-warning col-sm-10 col-sm-offset-2">
      We are currently working on allowing existing user to link their facebook account.
      If you're determined to connect your facebook account now, you can cancel your current account,
      and start over by signing in with Facebook. Sorry for this inconvenience.
    </div>
  </div>
<% end %>
